# ============================================================
# Invoice Bot - Configuration Template
# ============================================================
# Copy this file to config.yaml and fill in your values.
# config.yaml is mounted read-only into the container.
#
# Secrets (API keys, client IDs) should be set via environment
# variables — see .env.example. They can also be set here, but
# env vars take precedence when both are present.
# ============================================================

microsoft:
  # Azure App Registration Client ID.
  # Prefer setting via AZURE_CLIENT_ID env var (see .env.example).
  # client_id: "your-client-id"

  # Do NOT change this for personal @hotmail.com / @outlook.com accounts
  tenant_id: "consumers"

onedrive:
  # Name of the root folder in OneDrive where invoices will be stored.
  # The bot creates it automatically at the top level of your OneDrive if absent.
  # Subfolders YYYY/MM/ are created automatically.
  folder_name: "YOUR_FOLDER_NAME_HERE"

invoices:
  # Optional sender whitelist. If omitted or empty, ALL emails with attachments
  # are scanned — the AI classifier decides what is an invoice.
  # Uncomment and fill to restrict processing to specific senders only.
  # whitelisted_senders:
  #   - "factures@supplier.fr"

  # Per-sender dry-run override. Emails from these addresses are always routed
  # to the -DRY-RUN OneDrive folder and never written to the DB, regardless of
  # the global debug.dry_run flag. Useful for personal/shopping addresses.
  # dry_run_senders:
  #   - "shopping@you.at"

  # Internal senders — emails from these addresses are NOT suppliers.
  # The supplier name will be extracted from the document content instead of
  # the sender domain. Add the account owner's address and anyone who forwards
  # invoices on their behalf.
  # internal_senders:
  #   - "owner@hotmail.com"
  #   - "helper@gmail.com"

  # Subject keyword filter. Only emails whose subject contains at least one of
  # these keywords (case-insensitive) are processed.
  # Emails with an empty subject are always passed through.
  subject_keywords:
    - facture
    - invoice
    - avoir
    - recu
    - receipt
    - facturation
    - paiement
    - payment
    - bill
    - quittance
    - decompte
    - releve
    - cotisation
    - abonnement
    - subscription
    - confirmation de commande
    - order confirmation

schedule:
  # How often to check the inbox (in minutes)
  poll_interval_minutes: 10

  # Day of month to generate the Excel summary (1 = 1st of the month)
  report_day_of_month: 1

  # Hour (UTC) at which to generate the report
  report_hour: 8

classifier:
  # Anthropic API key for invoice classification (claude-haiku).
  # Prefer setting via ANTHROPIC_API_KEY env var (see .env.example).
  # api_key: "your-api-key"

  # Confidence threshold — below this, files are uploaded anyway (fail-safe)
  confidence_threshold: 0.5

  # Your own business names (the BUYER on invoices, not the supplier).
  # If Claude extracts one of these as the supplier, it is discarded and the
  # supplier name falls back to the sender domain. Case-insensitive.
  # owner_business_names:
  #   - "my restaurant"
  #   - "my company llc"

debug:
  # If set, only emails received after this date (YYYY-MM-DD) are processed.
  # Useful for initial setup or testing. Remove or leave empty in production.
  # since_date: "2025-01-01"

logging:
  # Log level for the bot. Supported values: DEBUG, INFO, WARNING, ERROR
  # Use DEBUG to see raw Claude responses, extraction char counts, and every HTTP request detail.
  # INFO (default) is recommended for production — one line per meaningful event.
  log_level: INFO

link_detection:
  # Keywords used to identify invoice download links in email bodies.
  # A URL is considered an invoice link if it contains any of these keywords
  # (case-insensitive). Applies to both HTML and plain-text emails.
  keywords:
    - invoice
    - receipt
    - download
    - bill
    - pdf
    - facture
    - recu
    - telecharger
    - telechargement
    - quittance
    - avoir


